<!DOCTYPE html>
<html>
<head>
  <script src="https://cdn.jsdelivr.net/npm/vega@5.26.1"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.16.3"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.23.0"></script>
</head>
<body>
  <div id="vis"/>
  <script>
    const spec = {
  "$schema": "https://vega.github.io/schema/vega/v5.json",
  "description": "a serpentine timeline. The serpentine shape can be an option for instances where an oblong canvas is not ideal. The shape can be customized using many of the signals below. Input bindings have been included for demonstration purposes",
  "padding": 15,
  "width": 300,
  "signals": [
    {
      "name": "width",
      "init": "width",
      "bind": {
        "name": "straight width",
        "input": "range",
        "min": 0,
        "max": 2000,
        "step": 1
      },
      "on": [
        {"events": [{"signal": "annotations"}], "update": "width+1"},
        {"events": [{"signal": "annotations"}], "update": "width-1"},
        {"events": [{"signal": "mO"}], "update": "width+1"},
        {"events": [{"signal": "mO"}], "update": "width-1"},
        {"events": [{"signal": "tLO"}], "update": "width+1"},
        {"events": [{"signal": "tLO"}], "update": "width-1"},
        {"events": [{"signal": "sN"}], "update": "width+1"},
        {"events": [{"signal": "sN"}], "update": "width-1"},
        {"events": [{"signal": "mO"}], "update": "height+1"},
        {"events": [{"signal": "mO"}], "update": "height-1"},
        {"events": [{"signal": "tLO"}], "update": "height+1"},
        {"events": [{"signal": "tLO"}], "update": "height-1"}
      ]
    },
    {
      "name": "sH",
      "description": "serpentine: diameter of arcs",
      "value": 125,
      "bind": {
        "name": "arc diameter",
        "input": "range",
        "min": 25,
        "max": 400,
        "step": 1
      }
    },
    {
      "name": "labelsOnHover",
      "description": "milestone: show labels on hover only",
      "value": false,
      "bind": {"name": "hover labels", "input": "checkbox"}
    },
    {
      "name": "sN",
      "description": "serpentine: number of arcs",
      "value": 2.2,
      "bind": {
        "name": "# of arcs",
        "input": "range",
        "min": 0,
        "max": 20,
        "step": 0.01
      }
    },
    {
      "name": "tC",
      "description": "ticks: number of axis ticks to display on the timeline",
      "value": 21,
      "bind": {
        "name": "tick count",
        "input": "range",
        "min": 0,
        "max": 100,
        "step": 1
      }
    },
    {
      "name": "tLO",
      "description": "ticks: the offset for the tick labels",
      "value": 8
    },
    {
      "name": "mO",
      "description": "milestone: the offset for the milestone markers",
      "value": 35,
      "bind": {
        "name": "milestone offset",
        "input": "range",
        "min": 0,
        "max": 50,
        "step": 0.5
      }
    },
    {
      "name": "sR0P",
      "description": "serpentine: percentage of width of canvas for the start of the timeline",
      "value": 0,
      "bind": {
        "name": "timeline x0 %",
        "input": "range",
        "min": 0,
        "max": 1,
        "step": 0.01
      }
    },
    {
      "name": "sLP",
      "description": "serpentine: percentage of total length of canvas for the end of the timeline",
      "value": 1,
      "bind": {
        "name": "timeline len %",
        "input": "range",
        "min": 0,
        "max": 1,
        "step": 0.01
      }
    },
    {
      "name": "annotationStart",
      "value": "",
      "bind": {"name": "start annotation", "input": "text"}
    },
    {
      "name": "annotationEnd",
      "value": "Today",
      "bind": {"name": "end annotation", "input": "text"}
    },
    {
      "name": "includeArrows",
      "value": true,
      "bind": {"name": "include arrows", "input": "checkbox"}
    },
    {
      "name": "sT",
      "description": "serpentine: thicknes of the line",
      "value": 5,
      "bind": {
        "name": "line thickness",
        "input": "range",
        "min": 1,
        "max": 10,
        "step": 0.5
      }
    },
    {
      "name": "domain",
      "init": "[year(now())-100, year(now())]",
      "description": "serpentine: manually set the domain extent for the timeline, otherwise set to null to have the domain calculated for you"
    },
    {
      "name": "sRange",
      "description": "serpentine: range for the serpentine scale",
      "update": "[sR0P*width,sL*sLP]"
    },
    {
      "name": "annotations",
      "description": "serpentine: annotations that appear at the start and end of the timeline",
      "update": "{start: (isValid(annotationStart) ? annotationStart : ''), end: (isValid(annotationEnd) ? annotationEnd : '')}"
    },
    {
      "name": "sD",
      "update": "[2, 2]",
      "description": "serpentine: dash array for the serpentine line"
    },
    {
      "name": "reverse",
      "description": "serpentine: boolean to indicate whether the scale for the timeline should be reversed",
      "value": false
    },
    {
      "name": "sPct",
      "description": "serpentine: percentage of width for the straight portions of the timeline",
      "value": 1,
      "update": "sPct < 0.25 ? 0 : sPct < 0.75 ? 0.5 : 1"
    },
    {
      "name": "sW",
      "description": "serpentine: horizontal length of straight segments",
      "update": "sPct*width"
    },
    {
      "name": "sL",
      "description": "serpentine: total length of line",
      "update": "(sN+1)*sW+(sN)*sH*PI/2"
    },
    {
      "name": "sA",
      "description": "serpentine: length of an arc segment",
      "update": "(sH*PI/2)"
    },
    {
      "name": "sWsA",
      "description": "serpentine: length of a line + arc segment",
      "update": "(sW + sH*PI/2)"
    },
    {
      "name": "sDomain",
      "description": "serpentine: domain for the serpentine scale",
      "init": "domain ? domain : [+extent(pluck(data('dataset'), 'domain'))[0], +extent(pluck(data('dataset'), 'domain'))[1]]"
    },
    {
      "name": "hoverFocus",
      "value": 0,
      "on": [
        {
          "events": {"type": "mouseover"},
          "update": "isValid(datum) && isValid(isValid(datum['domain'])) ? datum : null"
        },
        {"events": {"type": "mouseout"}, "update": "null"}
      ]
    },
    {
      "name": "height",
      "description": "calculated height",
      "update": "extent(pluck(data('serpentine'), 'y'))[1]"
    }
  ],
  "scales": [
    {
      "name": "sS1",
      "type": "linear",
      "zero": false,
      "reverse": {"signal": "reverse"},
      "domain": {"signal": "sDomain"},
      "range": {"signal": "sRange"}
    },
    {
      "name": "footerY",
      "type": "band",
      "domain": {"data": "footer", "field": "id"},
      "range": [
        {"signal": "height+60"},
        {"signal": "height+60+length(data('footer'))*11"}
      ]
    }
  ],
  "marks": [
    {
      "name": "axis_group",
      "description": "group containing all the axis marks - annotations, domain, arrow indicators, tick lines, tick labels on straightaways, tick labels on arcs",
      "type": "group",
      "marks": [
        {
          "name": "annotations",
          "description": "Text marks that appear at the start and end of the timeline. Configured using the 'annotations' signal",
          "from": {"data": "domain_extent"},
          "on": [{"trigger": "annotations", "modify": "annotations"}],
          "type": "text",
          "interactive": false,
          "encode": {
            "update": {
              "x": {"field": "x"},
              "y": {"field": "y"},
              "text": {
                "signal": "datum['category'] === 'start' ? annotations['start'] : annotations['end']"
              },
              "fontSize": {"value": 10},
              "baseline": {"value": "middle"},
              "align": {"field": "align"},
              "angle": {"field": "angle"},
              "dx": {"field": "dx"},
              "dy": {"signal": "1"},
              "fill": {"value": "gray"}
            }
          }
        },
        {
          "name": "serpentine_line",
          "description": "The serpentine-shaped line that acts as the axis domain line",
          "type": "line",
          "from": {"data": "serpentine"},
          "interactive": false,
          "encode": {
            "update": {
              "x": {"field": "x"},
              "y": {"field": "y"},
              "strokeDash": {"signal": "sD"},
              "stroke": {"value": "#888"},
              "strokeWidth": {"signal": "sT"}
            }
          }
        },
        {
          "name": "arrow_marks",
          "description": "The arrows to indicate direction that appear at the beginning and end of each arc+straightaway combonation",
          "type": "text",
          "from": {"data": "segment_ends"},
          "interactive": false,
          "encode": {
            "update": {
              "x": {"field": "x"},
              "y": {"field": "y"},
              "dy": {"value": 1},
              "text": {"value": "➤"},
              "fontSize": {"signal": "18"},
              "fill": {"value": "#000"},
              "stroke": {"value": "#fff"},
              "strokeWidth": {"value": 1},
              "angle": {"signal": "datum['direction'] === '→' ? 0 : 180"},
              "align": {"value": "center"},
              "baseline": {"value": "middle"}
            }
          }
        },
        {
          "name": "tick_marks",
          "description": "The line (text mark) designated to each tick",
          "from": {"data": "ticks"},
          "type": "text",
          "interactive": false,
          "encode": {
            "update": {
              "x": {"field": "x"},
              "y": {"field": "y"},
              "dy": {
                "signal": "2.5*( datum['type'] === 'straight' ? 1 : datum['side'] === 'right' ? (round(datum['alpha']*(180/PI)) >= 90 ? -1 : 4) : (round(datum['alpha']*(180/PI)) > 89 ? -1 : 4))"
              },
              "text": {"signal": "'|'"},
              "fontSize": {"signal": "7"},
              "fill": {"value": "#000"},
              "angle": {"field": "labelAngle"},
              "align": {"value": "center"},
              "baseline": {
                "signal": "datum['type'] === 'straight' ? 'top' : 'bottom'"
              }
            }
          }
        },
        {
          "name": "tick_labels_straight",
          "description": "The straightaway tick labels",
          "from": {"data": "ticks"},
          "type": "text",
          "interactive": false,
          "encode": {
            "update": {
              "x": {"field": "x"},
              "y": {"field": "y"},
              "dy": {"field": "dy"},
              "text": {"field": "domain"},
              "fontSize": {"signal": "10"},
              "fill": {"value": "#000"},
              "align": {"value": "center"},
              "angle": {"field": "labelAngle"},
              "baseline": {
                "signal": "datum['type'] === 'straight' ? 'top' : 'bottom'"
              }
            }
          }
        }
      ]
    },
    {
      "name": "milestone_connecting_lines",
      "description": "The milestone lines that connect the markers to labels",
      "from": {"data": "milestones"},
      "type": "text",
      "interactive": false,
      "encode": {
        "update": {
          "text": {"signal": "'|'"},
          "x": {"field": "x"},
          "y": {"field": "y"},
          "fontSize": {"value": 15},
          "fontWeight": {"value": 100},
          "dy": {
            "signal": "datum['type'] === 'arc' && (round(datum['alpha']*(180/PI)) > 89) ? 0.35 * (mO+3.5) : datum['dy']/2"
          },
          "align": {"value": "center"},
          "baseline": {"value": "middle"},
          "angle": {"field": "labelAngle"},
          "fillOpacity": {"value": 0.35},
          "opacity": {
            "signal": "isValid(hoverFocus) && datum['label'] === hoverFocus['label'] ? 1 : labelsOnHover ? 0 : 1"
          }
        }
      }
    },
    {
      "name": "milestone_markers",
      "description": "The milestone timeline markers",
      "from": {"data": "milestones"},
      "type": "symbol",
      "interactive": true,
      "encode": {
        "update": {
          "x": {"field": "x"},
          "y": {"field": "y"},
          "size": {
            "signal": "labelsOnHover && isValid(hoverFocus) && datum['label'] === hoverFocus['label'] ? 200 : 150"
          },
          "fill": {
            "signal": "labelsOnHover ? isValid(hoverFocus) && datum['label'] === hoverFocus['label'] ? 'firebrick' : '#e4b3b4' : 'firebrick'"
          },
          "stroke": {
            "signal": "labelsOnHover ? isValid(hoverFocus) && datum['label'] === hoverFocus['label'] ? '#fff' : 'firebrick' : '#fff'"
          },
          "strokeWidth": {"signal": "labelsOnHover ? 1 : 2"},
          "cursor": {"signal": "labelsOnHover ? 'pointer' : 'default'"}
        }
      }
    },
    {
      "name": "milestone_label_backgrounds",
      "description": "The white backgrounds for milestone labels",
      "from": {"data": "milestones"},
      "type": "text",
      "interactive": false,
      "encode": {
        "update": {
          "x": {"field": "x"},
          "y": {"field": "y"},
          "dy": {"field": "dy"},
          "text": {"signal": "datum['domain'] + ' - ' + datum['label']"},
          "fontSize": {"signal": "10"},
          "fill": {"value": "#fff"},
          "stroke": {"value": "#fff"},
          "strokeWidth": {"value": 7},
          "angle": {"field": "labelAngle"},
          "align": {"value": "center"},
          "baseline": {
            "signal": "datum['type'] === 'straight' ? 'top' : 'bottom'"
          },
          "opacity": {
            "signal": "isValid(hoverFocus) && datum['label'] === hoverFocus['label'] ? 1 : labelsOnHover ? 0 : 1"
          }
        }
      }
    },
    {
      "name": "milestone_labels",
      "description": "The milestone labels",
      "from": {"data": "milestones"},
      "type": "text",
      "interactive": false,
      "encode": {
        "update": {
          "x": {"field": "x"},
          "y": {"field": "y"},
          "dy": {"field": "dy"},
          "text": {"signal": "datum['domain'] + ' - ' + datum['label']"},
          "fontSize": {"signal": "10"},
          "fill": {"value": "firebrick"},
          "angle": {"field": "labelAngle"},
          "align": {"value": "center"},
          "baseline": {
            "signal": "datum['type'] === 'straight' ? 'top' : 'bottom'"
          },
          "opacity": {
            "signal": "isValid(hoverFocus) && datum['label'] === hoverFocus['label'] ? 1 : labelsOnHover ? 0 : 1"
          }
        }
      }
    }
  ],
  "data": [
    {
      "name": "dataset",
      "values": [
        {"domain": 1928, "label": "Major Event A"},
        {"domain": 1939, "label": "Major Event B"},
        {"domain": 1954, "label": "Major Event C"},
        {"domain": 1962, "label": "Major Event D"},
        {"domain": 1974, "label": "Major Event E"},
        {"domain": 1990, "label": "Major Event F"},
        {"domain": 2001, "label": "Major Event G"},
        {"domain": 2015, "label": "Major Event H"}
      ]
    },
    {
      "name": "serpentineDomain",
      "values": [
        {
          "domain": [
            1924,
            1924.1,
            1924.2,
            1924.3,
            1924.4,
            1924.5,
            1924.6,
            1924.7,
            1924.8,
            1924.9,
            1925,
            1925.1,
            1925.2,
            1925.3,
            1925.4,
            1925.5,
            1925.6,
            1925.7,
            1925.8,
            1925.9,
            1926,
            1926.1,
            1926.2,
            1926.3,
            1926.4,
            1926.5,
            1926.6,
            1926.7,
            1926.8,
            1926.9,
            1927,
            1927.1,
            1927.2,
            1927.3,
            1927.4,
            1927.5,
            1927.6,
            1927.7,
            1927.8,
            1927.9,
            1928,
            1928.1,
            1928.2,
            1928.3,
            1928.4,
            1928.5,
            1928.6,
            1928.7,
            1928.8,
            1928.9,
            1929,
            1929.1,
            1929.2,
            1929.3,
            1929.4,
            1929.5,
            1929.6,
            1929.7,
            1929.8,
            1929.9,
            1930,
            1930.1,
            1930.2,
            1930.3,
            1930.4,
            1930.5,
            1930.6,
            1930.7,
            1930.8,
            1930.9,
            1931,
            1931.1,
            1931.2,
            1931.3,
            1931.4,
            1931.5,
            1931.6,
            1931.7,
            1931.8,
            1931.9,
            1932,
            1932.1,
            1932.2,
            1932.3,
            1932.4,
            1932.5,
            1932.6,
            1932.7,
            1932.8,
            1932.9,
            1933,
            1933.1,
            1933.2,
            1933.3,
            1933.4,
            1933.5,
            1933.6,
            1933.7,
            1933.8,
            1933.9,
            1934,
            1934.1,
            1934.2,
            1934.3,
            1934.4,
            1934.5,
            1934.6,
            1934.7,
            1934.8,
            1934.9,
            1935,
            1935.1,
            1935.2,
            1935.3,
            1935.4,
            1935.5,
            1935.6,
            1935.7,
            1935.8,
            1935.9,
            1936,
            1936.1,
            1936.2,
            1936.3,
            1936.4,
            1936.5,
            1936.6,
            1936.7,
            1936.8,
            1936.9,
            1937,
            1937.1,
            1937.2,
            1937.3,
            1937.4,
            1937.5,
            1937.6,
            1937.7,
            1937.8,
            1937.9,
            1938,
            1938.1,
            1938.2,
            1938.3,
            1938.4,
            1938.5,
            1938.6,
            1938.7,
            1938.8,
            1938.9,
            1939,
            1939.1,
            1939.2,
            1939.3,
            1939.4,
            1939.5,
            1939.6,
            1939.7,
            1939.8,
            1939.9,
            1940,
            1940.1,
            1940.2,
            1940.3,
            1940.4,
            1940.5,
            1940.6,
            1940.7,
            1940.8,
            1940.9,
            1941,
            1941.1,
            1941.2,
            1941.3,
            1941.4,
            1941.5,
            1941.6,
            1941.7,
            1941.8,
            1941.9,
            1942,
            1942.1,
            1942.2,
            1942.3,
            1942.4,
            1942.5,
            1942.6,
            1942.7,
            1942.8,
            1942.9,
            1943,
            1943.1,
            1943.2,
            1943.3,
            1943.4,
            1943.5,
            1943.6,
            1943.7,
            1943.8,
            1943.9,
            1944,
            1944.1,
            1944.2,
            1944.3,
            1944.4,
            1944.5,
            1944.6,
            1944.7,
            1944.8,
            1944.9,
            1945,
            1945.1,
            1945.2,
            1945.3,
            1945.4,
            1945.5,
            1945.6,
            1945.7,
            1945.8,
            1945.9,
            1946,
            1946.1,
            1946.2,
            1946.3,
            1946.4,
            1946.5,
            1946.6,
            1946.7,
            1946.8,
            1946.9,
            1947,
            1947.1,
            1947.2,
            1947.3,
            1947.4,
            1947.5,
            1947.6,
            1947.7,
            1947.8,
            1947.9,
            1948,
            1948.1,
            1948.2,
            1948.3,
            1948.4,
            1948.5,
            1948.6,
            1948.7,
            1948.8,
            1948.9,
            1949,
            1949.1,
            1949.2,
            1949.3,
            1949.4,
            1949.5,
            1949.6,
            1949.7,
            1949.8,
            1949.9,
            1950,
            1950.1,
            1950.2,
            1950.3,
            1950.4,
            1950.5,
            1950.6,
            1950.7,
            1950.8,
            1950.9,
            1951,
            1951.1,
            1951.2,
            1951.3,
            1951.4,
            1951.5,
            1951.6,
            1951.7,
            1951.8,
            1951.9,
            1952,
            1952.1,
            1952.2,
            1952.3,
            1952.4,
            1952.5,
            1952.6,
            1952.7,
            1952.8,
            1952.9,
            1953,
            1953.1,
            1953.2,
            1953.3,
            1953.4,
            1953.5,
            1953.6,
            1953.7,
            1953.8,
            1953.9,
            1954,
            1954.1,
            1954.2,
            1954.3,
            1954.4,
            1954.5,
            1954.6,
            1954.7,
            1954.8,
            1954.9,
            1955,
            1955.1,
            1955.2,
            1955.3,
            1955.4,
            1955.5,
            1955.6,
            1955.7,
            1955.8,
            1955.9,
            1956,
            1956.1,
            1956.2,
            1956.3,
            1956.4,
            1956.5,
            1956.6,
            1956.7,
            1956.8,
            1956.9,
            1957,
            1957.1,
            1957.2,
            1957.3,
            1957.4,
            1957.5,
            1957.6,
            1957.7,
            1957.8,
            1957.9,
            1958,
            1958.1,
            1958.2,
            1958.3,
            1958.4,
            1958.5,
            1958.6,
            1958.7,
            1958.8,
            1958.9,
            1959,
            1959.1,
            1959.2,
            1959.3,
            1959.4,
            1959.5,
            1959.6,
            1959.7,
            1959.8,
            1959.9,
            1960,
            1960.1,
            1960.2,
            1960.3,
            1960.4,
            1960.5,
            1960.6,
            1960.7,
            1960.8,
            1960.9,
            1961,
            1961.1,
            1961.2,
            1961.3,
            1961.4,
            1961.5,
            1961.6,
            1961.7,
            1961.8,
            1961.9,
            1962,
            1962.1,
            1962.2,
            1962.3,
            1962.4,
            1962.5,
            1962.6,
            1962.7,
            1962.8,
            1962.9,
            1963,
            1963.1,
            1963.2,
            1963.3,
            1963.4,
            1963.5,
            1963.6,
            1963.7,
            1963.8,
            1963.9,
            1964,
            1964.1,
            1964.2,
            1964.3,
            1964.4,
            1964.5,
            1964.6,
            1964.7,
            1964.8,
            1964.9,
            1965,
            1965.1,
            1965.2,
            1965.3,
            1965.4,
            1965.5,
            1965.6,
            1965.7,
            1965.8,
            1965.9,
            1966,
            1966.1,
            1966.2,
            1966.3,
            1966.4,
            1966.5,
            1966.6,
            1966.7,
            1966.8,
            1966.9,
            1967,
            1967.1,
            1967.2,
            1967.3,
            1967.4,
            1967.5,
            1967.6,
            1967.7,
            1967.8,
            1967.9,
            1968,
            1968.1,
            1968.2,
            1968.3,
            1968.4,
            1968.5,
            1968.6,
            1968.7,
            1968.8,
            1968.9,
            1969,
            1969.1,
            1969.2,
            1969.3,
            1969.4,
            1969.5,
            1969.6,
            1969.7,
            1969.8,
            1969.9,
            1970,
            1970.1,
            1970.2,
            1970.3,
            1970.4,
            1970.5,
            1970.6,
            1970.7,
            1970.8,
            1970.9,
            1971,
            1971.1,
            1971.2,
            1971.3,
            1971.4,
            1971.5,
            1971.6,
            1971.7,
            1971.8,
            1971.9,
            1972,
            1972.1,
            1972.2,
            1972.3,
            1972.4,
            1972.5,
            1972.6,
            1972.7,
            1972.8,
            1972.9,
            1973,
            1973.1,
            1973.2,
            1973.3,
            1973.4,
            1973.5,
            1973.6,
            1973.7,
            1973.8,
            1973.9,
            1974,
            1974.1,
            1974.2,
            1974.3,
            1974.4,
            1974.5,
            1974.6,
            1974.7,
            1974.8,
            1974.9,
            1975,
            1975.1,
            1975.2,
            1975.3,
            1975.4,
            1975.5,
            1975.6,
            1975.7,
            1975.8,
            1975.9,
            1976,
            1976.1,
            1976.2,
            1976.3,
            1976.4,
            1976.5,
            1976.6,
            1976.7,
            1976.8,
            1976.9,
            1977,
            1977.1,
            1977.2,
            1977.3,
            1977.4,
            1977.5,
            1977.6,
            1977.7,
            1977.8,
            1977.9,
            1978,
            1978.1,
            1978.2,
            1978.3,
            1978.4,
            1978.5,
            1978.6,
            1978.7,
            1978.8,
            1978.9,
            1979,
            1979.1,
            1979.2,
            1979.3,
            1979.4,
            1979.5,
            1979.6,
            1979.7,
            1979.8,
            1979.9,
            1980,
            1980.1,
            1980.2,
            1980.3,
            1980.4,
            1980.5,
            1980.6,
            1980.7,
            1980.8,
            1980.9,
            1981,
            1981.1,
            1981.2,
            1981.3,
            1981.4,
            1981.5,
            1981.6,
            1981.7,
            1981.8,
            1981.9,
            1982,
            1982.1,
            1982.2,
            1982.3,
            1982.4,
            1982.5,
            1982.6,
            1982.7,
            1982.8,
            1982.9,
            1983,
            1983.1,
            1983.2,
            1983.3,
            1983.4,
            1983.5,
            1983.6,
            1983.7,
            1983.8,
            1983.9,
            1984,
            1984.1,
            1984.2,
            1984.3,
            1984.4,
            1984.5,
            1984.6,
            1984.7,
            1984.8,
            1984.9,
            1985,
            1985.1,
            1985.2,
            1985.3,
            1985.4,
            1985.5,
            1985.6,
            1985.7,
            1985.8,
            1985.9,
            1986,
            1986.1,
            1986.2,
            1986.3,
            1986.4,
            1986.5,
            1986.6,
            1986.7,
            1986.8,
            1986.9,
            1987,
            1987.1,
            1987.2,
            1987.3,
            1987.4,
            1987.5,
            1987.6,
            1987.7,
            1987.8,
            1987.9,
            1988,
            1988.1,
            1988.2,
            1988.3,
            1988.4,
            1988.5,
            1988.6,
            1988.7,
            1988.8,
            1988.9,
            1989,
            1989.1,
            1989.2,
            1989.3,
            1989.4,
            1989.5,
            1989.6,
            1989.7,
            1989.8,
            1989.9,
            1990,
            1990.1,
            1990.2,
            1990.3,
            1990.4,
            1990.5,
            1990.6,
            1990.7,
            1990.8,
            1990.9,
            1991,
            1991.1,
            1991.2,
            1991.3,
            1991.4,
            1991.5,
            1991.6,
            1991.7,
            1991.8,
            1991.9,
            1992,
            1992.1,
            1992.2,
            1992.3,
            1992.4,
            1992.5,
            1992.6,
            1992.7,
            1992.8,
            1992.9,
            1993,
            1993.1,
            1993.2,
            1993.3,
            1993.4,
            1993.5,
            1993.6,
            1993.7,
            1993.8,
            1993.9,
            1994,
            1994.1,
            1994.2,
            1994.3,
            1994.4,
            1994.5,
            1994.6,
            1994.7,
            1994.8,
            1994.9,
            1995,
            1995.1,
            1995.2,
            1995.3,
            1995.4,
            1995.5,
            1995.6,
            1995.7,
            1995.8,
            1995.9,
            1996,
            1996.1,
            1996.2,
            1996.3,
            1996.4,
            1996.5,
            1996.6,
            1996.7,
            1996.8,
            1996.9,
            1997,
            1997.1,
            1997.2,
            1997.3,
            1997.4,
            1997.5,
            1997.6,
            1997.7,
            1997.8,
            1997.9,
            1998,
            1998.1,
            1998.2,
            1998.3,
            1998.4,
            1998.5,
            1998.6,
            1998.7,
            1998.8,
            1998.9,
            1999,
            1999.1,
            1999.2,
            1999.3,
            1999.4,
            1999.5,
            1999.6,
            1999.7,
            1999.8,
            1999.9,
            2000,
            2000.1,
            2000.2,
            2000.3,
            2000.4,
            2000.5,
            2000.6,
            2000.7,
            2000.8,
            2000.9,
            2001,
            2001.1,
            2001.2,
            2001.3,
            2001.4,
            2001.5,
            2001.6,
            2001.7,
            2001.8,
            2001.9,
            2002,
            2002.1,
            2002.2,
            2002.3,
            2002.4,
            2002.5,
            2002.6,
            2002.7,
            2002.8,
            2002.9,
            2003,
            2003.1,
            2003.2,
            2003.3,
            2003.4,
            2003.5,
            2003.6,
            2003.7,
            2003.8,
            2003.9,
            2004,
            2004.1,
            2004.2,
            2004.3,
            2004.4,
            2004.5,
            2004.6,
            2004.7,
            2004.8,
            2004.9,
            2005,
            2005.1,
            2005.2,
            2005.3,
            2005.4,
            2005.5,
            2005.6,
            2005.7,
            2005.8,
            2005.9,
            2006,
            2006.1,
            2006.2,
            2006.3,
            2006.4,
            2006.5,
            2006.6,
            2006.7,
            2006.8,
            2006.9,
            2007,
            2007.1,
            2007.2,
            2007.3,
            2007.4,
            2007.5,
            2007.6,
            2007.7,
            2007.8,
            2007.9,
            2008,
            2008.1,
            2008.2,
            2008.3,
            2008.4,
            2008.5,
            2008.6,
            2008.7,
            2008.8,
            2008.9,
            2009,
            2009.1,
            2009.2,
            2009.3,
            2009.4,
            2009.5,
            2009.6,
            2009.7,
            2009.8,
            2009.9,
            2010,
            2010.1,
            2010.2,
            2010.3,
            2010.4,
            2010.5,
            2010.6,
            2010.7,
            2010.8,
            2010.9,
            2011,
            2011.1,
            2011.2,
            2011.3,
            2011.4,
            2011.5,
            2011.6,
            2011.7,
            2011.8,
            2011.9,
            2012,
            2012.1,
            2012.2,
            2012.3,
            2012.4,
            2012.5,
            2012.6,
            2012.7,
            2012.8,
            2012.9,
            2013,
            2013.1,
            2013.2,
            2013.3,
            2013.4,
            2013.5,
            2013.6,
            2013.7,
            2013.8,
            2013.9,
            2014,
            2014.1,
            2014.2,
            2014.3,
            2014.4,
            2014.5,
            2014.6,
            2014.7,
            2014.8,
            2014.9,
            2015,
            2015.1,
            2015.2,
            2015.3,
            2015.4,
            2015.5,
            2015.6,
            2015.7,
            2015.8,
            2015.9,
            2016,
            2016.1,
            2016.2,
            2016.3,
            2016.4,
            2016.5,
            2016.6,
            2016.7,
            2016.8,
            2016.9,
            2017,
            2017.1,
            2017.2,
            2017.3,
            2017.4,
            2017.5,
            2017.6,
            2017.7,
            2017.8,
            2017.9,
            2018,
            2018.1,
            2018.2,
            2018.3,
            2018.4,
            2018.5,
            2018.6,
            2018.7,
            2018.8,
            2018.9,
            2019,
            2019.1,
            2019.2,
            2019.3,
            2019.4,
            2019.5,
            2019.6,
            2019.7,
            2019.8,
            2019.9,
            2020,
            2020.1,
            2020.2,
            2020.3,
            2020.4,
            2020.5,
            2020.6,
            2020.7,
            2020.8,
            2020.9,
            2021,
            2021.1,
            2021.2,
            2021.3,
            2021.4,
            2021.5,
            2021.6,
            2021.7,
            2021.8,
            2021.9,
            2022,
            2022.1,
            2022.2,
            2022.3,
            2022.4,
            2022.5,
            2022.6,
            2022.7,
            2022.8,
            2022.9,
            2023,
            2023.1,
            2023.2,
            2023.3,
            2023.4,
            2023.5,
            2023.6,
            2023.7,
            2023.8,
            2023.9
          ]
        }
      ],
      "transform": [
        {
          "type": "formula",
          "expr": "sequence(sDomain[0],sDomain[1], 0.1 )",
          "as": "domain"
        },
        {"type": "flatten", "fields": ["domain"]}
      ]
    },
    {
      "name": "milestoneDomain",
      "source": "dataset",
      "transform": [{"type": "project", "fields": ["domain"]}]
    },
    {
      "name": "tickDomain",
      "values": [
        {
          "id": [
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20,
            21
          ]
        }
      ],
      "transform": [
        {"type": "formula", "expr": "sequence(1,tC+1, 1)", "as": "id"},
        {"type": "flatten", "fields": ["id"]},
        {
          "type": "formula",
          "expr": "datum['id'] === 1 ? sDomain[0] : datum['id'] === tC ? sDomain[1] : null",
          "as": "domain"
        },
        {
          "type": "formula",
          "expr": "round(isValid(datum['domain']) ? datum['domain'] : (sDomain[0] + (sDomain[1]-sDomain[0])*((datum['id']-1)/(tC-1))))",
          "as": "domain"
        },
        {"type": "project", "fields": ["domain"]}
      ]
    },
    {
      "name": "componentEncodings",
      "values": [
        {"category": "start", "timestamp": 1705483098596, "domain": [1924]},
        {
          "category": "serpentine",
          "timestamp": 1705483098596,
          "domain": [
            1924,
            1924.1,
            1924.2,
            1924.3,
            1924.4,
            1924.5,
            1924.6,
            1924.7,
            1924.8,
            1924.9,
            1925,
            1925.1,
            1925.2,
            1925.3,
            1925.4,
            1925.5,
            1925.6,
            1925.7,
            1925.8,
            1925.9,
            1926,
            1926.1,
            1926.2,
            1926.3,
            1926.4,
            1926.5,
            1926.6,
            1926.7,
            1926.8,
            1926.9,
            1927,
            1927.1,
            1927.2,
            1927.3,
            1927.4,
            1927.5,
            1927.6,
            1927.7,
            1927.8,
            1927.9,
            1928,
            1928.1,
            1928.2,
            1928.3,
            1928.4,
            1928.5,
            1928.6,
            1928.7,
            1928.8,
            1928.9,
            1929,
            1929.1,
            1929.2,
            1929.3,
            1929.4,
            1929.5,
            1929.6,
            1929.7,
            1929.8,
            1929.9,
            1930,
            1930.1,
            1930.2,
            1930.3,
            1930.4,
            1930.5,
            1930.6,
            1930.7,
            1930.8,
            1930.9,
            1931,
            1931.1,
            1931.2,
            1931.3,
            1931.4,
            1931.5,
            1931.6,
            1931.7,
            1931.8,
            1931.9,
            1932,
            1932.1,
            1932.2,
            1932.3,
            1932.4,
            1932.5,
            1932.6,
            1932.7,
            1932.8,
            1932.9,
            1933,
            1933.1,
            1933.2,
            1933.3,
            1933.4,
            1933.5,
            1933.6,
            1933.7,
            1933.8,
            1933.9,
            1934,
            1934.1,
            1934.2,
            1934.3,
            1934.4,
            1934.5,
            1934.6,
            1934.7,
            1934.8,
            1934.9,
            1935,
            1935.1,
            1935.2,
            1935.3,
            1935.4,
            1935.5,
            1935.6,
            1935.7,
            1935.8,
            1935.9,
            1936,
            1936.1,
            1936.2,
            1936.3,
            1936.4,
            1936.5,
            1936.6,
            1936.7,
            1936.8,
            1936.9,
            1937,
            1937.1,
            1937.2,
            1937.3,
            1937.4,
            1937.5,
            1937.6,
            1937.7,
            1937.8,
            1937.9,
            1938,
            1938.1,
            1938.2,
            1938.3,
            1938.4,
            1938.5,
            1938.6,
            1938.7,
            1938.8,
            1938.9,
            1939,
            1939.1,
            1939.2,
            1939.3,
            1939.4,
            1939.5,
            1939.6,
            1939.7,
            1939.8,
            1939.9,
            1940,
            1940.1,
            1940.2,
            1940.3,
            1940.4,
            1940.5,
            1940.6,
            1940.7,
            1940.8,
            1940.9,
            1941,
            1941.1,
            1941.2,
            1941.3,
            1941.4,
            1941.5,
            1941.6,
            1941.7,
            1941.8,
            1941.9,
            1942,
            1942.1,
            1942.2,
            1942.3,
            1942.4,
            1942.5,
            1942.6,
            1942.7,
            1942.8,
            1942.9,
            1943,
            1943.1,
            1943.2,
            1943.3,
            1943.4,
            1943.5,
            1943.6,
            1943.7,
            1943.8,
            1943.9,
            1944,
            1944.1,
            1944.2,
            1944.3,
            1944.4,
            1944.5,
            1944.6,
            1944.7,
            1944.8,
            1944.9,
            1945,
            1945.1,
            1945.2,
            1945.3,
            1945.4,
            1945.5,
            1945.6,
            1945.7,
            1945.8,
            1945.9,
            1946,
            1946.1,
            1946.2,
            1946.3,
            1946.4,
            1946.5,
            1946.6,
            1946.7,
            1946.8,
            1946.9,
            1947,
            1947.1,
            1947.2,
            1947.3,
            1947.4,
            1947.5,
            1947.6,
            1947.7,
            1947.8,
            1947.9,
            1948,
            1948.1,
            1948.2,
            1948.3,
            1948.4,
            1948.5,
            1948.6,
            1948.7,
            1948.8,
            1948.9,
            1949,
            1949.1,
            1949.2,
            1949.3,
            1949.4,
            1949.5,
            1949.6,
            1949.7,
            1949.8,
            1949.9,
            1950,
            1950.1,
            1950.2,
            1950.3,
            1950.4,
            1950.5,
            1950.6,
            1950.7,
            1950.8,
            1950.9,
            1951,
            1951.1,
            1951.2,
            1951.3,
            1951.4,
            1951.5,
            1951.6,
            1951.7,
            1951.8,
            1951.9,
            1952,
            1952.1,
            1952.2,
            1952.3,
            1952.4,
            1952.5,
            1952.6,
            1952.7,
            1952.8,
            1952.9,
            1953,
            1953.1,
            1953.2,
            1953.3,
            1953.4,
            1953.5,
            1953.6,
            1953.7,
            1953.8,
            1953.9,
            1954,
            1954.1,
            1954.2,
            1954.3,
            1954.4,
            1954.5,
            1954.6,
            1954.7,
            1954.8,
            1954.9,
            1955,
            1955.1,
            1955.2,
            1955.3,
            1955.4,
            1955.5,
            1955.6,
            1955.7,
            1955.8,
            1955.9,
            1956,
            1956.1,
            1956.2,
            1956.3,
            1956.4,
            1956.5,
            1956.6,
            1956.7,
            1956.8,
            1956.9,
            1957,
            1957.1,
            1957.2,
            1957.3,
            1957.4,
            1957.5,
            1957.6,
            1957.7,
            1957.8,
            1957.9,
            1958,
            1958.1,
            1958.2,
            1958.3,
            1958.4,
            1958.5,
            1958.6,
            1958.7,
            1958.8,
            1958.9,
            1959,
            1959.1,
            1959.2,
            1959.3,
            1959.4,
            1959.5,
            1959.6,
            1959.7,
            1959.8,
            1959.9,
            1960,
            1960.1,
            1960.2,
            1960.3,
            1960.4,
            1960.5,
            1960.6,
            1960.7,
            1960.8,
            1960.9,
            1961,
            1961.1,
            1961.2,
            1961.3,
            1961.4,
            1961.5,
            1961.6,
            1961.7,
            1961.8,
            1961.9,
            1962,
            1962.1,
            1962.2,
            1962.3,
            1962.4,
            1962.5,
            1962.6,
            1962.7,
            1962.8,
            1962.9,
            1963,
            1963.1,
            1963.2,
            1963.3,
            1963.4,
            1963.5,
            1963.6,
            1963.7,
            1963.8,
            1963.9,
            1964,
            1964.1,
            1964.2,
            1964.3,
            1964.4,
            1964.5,
            1964.6,
            1964.7,
            1964.8,
            1964.9,
            1965,
            1965.1,
            1965.2,
            1965.3,
            1965.4,
            1965.5,
            1965.6,
            1965.7,
            1965.8,
            1965.9,
            1966,
            1966.1,
            1966.2,
            1966.3,
            1966.4,
            1966.5,
            1966.6,
            1966.7,
            1966.8,
            1966.9,
            1967,
            1967.1,
            1967.2,
            1967.3,
            1967.4,
            1967.5,
            1967.6,
            1967.7,
            1967.8,
            1967.9,
            1968,
            1968.1,
            1968.2,
            1968.3,
            1968.4,
            1968.5,
            1968.6,
            1968.7,
            1968.8,
            1968.9,
            1969,
            1969.1,
            1969.2,
            1969.3,
            1969.4,
            1969.5,
            1969.6,
            1969.7,
            1969.8,
            1969.9,
            1970,
            1970.1,
            1970.2,
            1970.3,
            1970.4,
            1970.5,
            1970.6,
            1970.7,
            1970.8,
            1970.9,
            1971,
            1971.1,
            1971.2,
            1971.3,
            1971.4,
            1971.5,
            1971.6,
            1971.7,
            1971.8,
            1971.9,
            1972,
            1972.1,
            1972.2,
            1972.3,
            1972.4,
            1972.5,
            1972.6,
            1972.7,
            1972.8,
            1972.9,
            1973,
            1973.1,
            1973.2,
            1973.3,
            1973.4,
            1973.5,
            1973.6,
            1973.7,
            1973.8,
            1973.9,
            1974,
            1974.1,
            1974.2,
            1974.3,
            1974.4,
            1974.5,
            1974.6,
            1974.7,
            1974.8,
            1974.9,
            1975,
            1975.1,
            1975.2,
            1975.3,
            1975.4,
            1975.5,
            1975.6,
            1975.7,
            1975.8,
            1975.9,
            1976,
            1976.1,
            1976.2,
            1976.3,
            1976.4,
            1976.5,
            1976.6,
            1976.7,
            1976.8,
            1976.9,
            1977,
            1977.1,
            1977.2,
            1977.3,
            1977.4,
            1977.5,
            1977.6,
            1977.7,
            1977.8,
            1977.9,
            1978,
            1978.1,
            1978.2,
            1978.3,
            1978.4,
            1978.5,
            1978.6,
            1978.7,
            1978.8,
            1978.9,
            1979,
            1979.1,
            1979.2,
            1979.3,
            1979.4,
            1979.5,
            1979.6,
            1979.7,
            1979.8,
            1979.9,
            1980,
            1980.1,
            1980.2,
            1980.3,
            1980.4,
            1980.5,
            1980.6,
            1980.7,
            1980.8,
            1980.9,
            1981,
            1981.1,
            1981.2,
            1981.3,
            1981.4,
            1981.5,
            1981.6,
            1981.7,
            1981.8,
            1981.9,
            1982,
            1982.1,
            1982.2,
            1982.3,
            1982.4,
            1982.5,
            1982.6,
            1982.7,
            1982.8,
            1982.9,
            1983,
            1983.1,
            1983.2,
            1983.3,
            1983.4,
            1983.5,
            1983.6,
            1983.7,
            1983.8,
            1983.9,
            1984,
            1984.1,
            1984.2,
            1984.3,
            1984.4,
            1984.5,
            1984.6,
            1984.7,
            1984.8,
            1984.9,
            1985,
            1985.1,
            1985.2,
            1985.3,
            1985.4,
            1985.5,
            1985.6,
            1985.7,
            1985.8,
            1985.9,
            1986,
            1986.1,
            1986.2,
            1986.3,
            1986.4,
            1986.5,
            1986.6,
            1986.7,
            1986.8,
            1986.9,
            1987,
            1987.1,
            1987.2,
            1987.3,
            1987.4,
            1987.5,
            1987.6,
            1987.7,
            1987.8,
            1987.9,
            1988,
            1988.1,
            1988.2,
            1988.3,
            1988.4,
            1988.5,
            1988.6,
            1988.7,
            1988.8,
            1988.9,
            1989,
            1989.1,
            1989.2,
            1989.3,
            1989.4,
            1989.5,
            1989.6,
            1989.7,
            1989.8,
            1989.9,
            1990,
            1990.1,
            1990.2,
            1990.3,
            1990.4,
            1990.5,
            1990.6,
            1990.7,
            1990.8,
            1990.9,
            1991,
            1991.1,
            1991.2,
            1991.3,
            1991.4,
            1991.5,
            1991.6,
            1991.7,
            1991.8,
            1991.9,
            1992,
            1992.1,
            1992.2,
            1992.3,
            1992.4,
            1992.5,
            1992.6,
            1992.7,
            1992.8,
            1992.9,
            1993,
            1993.1,
            1993.2,
            1993.3,
            1993.4,
            1993.5,
            1993.6,
            1993.7,
            1993.8,
            1993.9,
            1994,
            1994.1,
            1994.2,
            1994.3,
            1994.4,
            1994.5,
            1994.6,
            1994.7,
            1994.8,
            1994.9,
            1995,
            1995.1,
            1995.2,
            1995.3,
            1995.4,
            1995.5,
            1995.6,
            1995.7,
            1995.8,
            1995.9,
            1996,
            1996.1,
            1996.2,
            1996.3,
            1996.4,
            1996.5,
            1996.6,
            1996.7,
            1996.8,
            1996.9,
            1997,
            1997.1,
            1997.2,
            1997.3,
            1997.4,
            1997.5,
            1997.6,
            1997.7,
            1997.8,
            1997.9,
            1998,
            1998.1,
            1998.2,
            1998.3,
            1998.4,
            1998.5,
            1998.6,
            1998.7,
            1998.8,
            1998.9,
            1999,
            1999.1,
            1999.2,
            1999.3,
            1999.4,
            1999.5,
            1999.6,
            1999.7,
            1999.8,
            1999.9,
            2000,
            2000.1,
            2000.2,
            2000.3,
            2000.4,
            2000.5,
            2000.6,
            2000.7,
            2000.8,
            2000.9,
            2001,
            2001.1,
            2001.2,
            2001.3,
            2001.4,
            2001.5,
            2001.6,
            2001.7,
            2001.8,
            2001.9,
            2002,
            2002.1,
            2002.2,
            2002.3,
            2002.4,
            2002.5,
            2002.6,
            2002.7,
            2002.8,
            2002.9,
            2003,
            2003.1,
            2003.2,
            2003.3,
            2003.4,
            2003.5,
            2003.6,
            2003.7,
            2003.8,
            2003.9,
            2004,
            2004.1,
            2004.2,
            2004.3,
            2004.4,
            2004.5,
            2004.6,
            2004.7,
            2004.8,
            2004.9,
            2005,
            2005.1,
            2005.2,
            2005.3,
            2005.4,
            2005.5,
            2005.6,
            2005.7,
            2005.8,
            2005.9,
            2006,
            2006.1,
            2006.2,
            2006.3,
            2006.4,
            2006.5,
            2006.6,
            2006.7,
            2006.8,
            2006.9,
            2007,
            2007.1,
            2007.2,
            2007.3,
            2007.4,
            2007.5,
            2007.6,
            2007.7,
            2007.8,
            2007.9,
            2008,
            2008.1,
            2008.2,
            2008.3,
            2008.4,
            2008.5,
            2008.6,
            2008.7,
            2008.8,
            2008.9,
            2009,
            2009.1,
            2009.2,
            2009.3,
            2009.4,
            2009.5,
            2009.6,
            2009.7,
            2009.8,
            2009.9,
            2010,
            2010.1,
            2010.2,
            2010.3,
            2010.4,
            2010.5,
            2010.6,
            2010.7,
            2010.8,
            2010.9,
            2011,
            2011.1,
            2011.2,
            2011.3,
            2011.4,
            2011.5,
            2011.6,
            2011.7,
            2011.8,
            2011.9,
            2012,
            2012.1,
            2012.2,
            2012.3,
            2012.4,
            2012.5,
            2012.6,
            2012.7,
            2012.8,
            2012.9,
            2013,
            2013.1,
            2013.2,
            2013.3,
            2013.4,
            2013.5,
            2013.6,
            2013.7,
            2013.8,
            2013.9,
            2014,
            2014.1,
            2014.2,
            2014.3,
            2014.4,
            2014.5,
            2014.6,
            2014.7,
            2014.8,
            2014.9,
            2015,
            2015.1,
            2015.2,
            2015.3,
            2015.4,
            2015.5,
            2015.6,
            2015.7,
            2015.8,
            2015.9,
            2016,
            2016.1,
            2016.2,
            2016.3,
            2016.4,
            2016.5,
            2016.6,
            2016.7,
            2016.8,
            2016.9,
            2017,
            2017.1,
            2017.2,
            2017.3,
            2017.4,
            2017.5,
            2017.6,
            2017.7,
            2017.8,
            2017.9,
            2018,
            2018.1,
            2018.2,
            2018.3,
            2018.4,
            2018.5,
            2018.6,
            2018.7,
            2018.8,
            2018.9,
            2019,
            2019.1,
            2019.2,
            2019.3,
            2019.4,
            2019.5,
            2019.6,
            2019.7,
            2019.8,
            2019.9,
            2020,
            2020.1,
            2020.2,
            2020.3,
            2020.4,
            2020.5,
            2020.6,
            2020.7,
            2020.8,
            2020.9,
            2021,
            2021.1,
            2021.2,
            2021.3,
            2021.4,
            2021.5,
            2021.6,
            2021.7,
            2021.8,
            2021.9,
            2022,
            2022.1,
            2022.2,
            2022.3,
            2022.4,
            2022.5,
            2022.6,
            2022.7,
            2022.8,
            2022.9,
            2023,
            2023.1,
            2023.2,
            2023.3,
            2023.4,
            2023.5,
            2023.6,
            2023.7,
            2023.8,
            2023.9
          ]
        },
        {
          "category": "milestone",
          "timestamp": 1705483098596,
          "domain": [1928, 1939, 1954, 1962, 1974, 1990, 2001, 2015]
        },
        {
          "category": "tick",
          "timestamp": 1705483098596,
          "domain": [
            1924,
            1929,
            1934,
            1939,
            1944,
            1949,
            1954,
            1959,
            1964,
            1969,
            1974,
            1979,
            1984,
            1989,
            1994,
            1999,
            2004,
            2009,
            2014,
            2019,
            2024
          ]
        },
        {"category": "end", "timestamp": 1705483098596, "domain": [2024]}
      ],
      "transform": [
        {"type": "formula", "expr": "now()", "as": "timestamp"},
        {
          "type": "formula",
          "expr": "datum['category'] === 'start' ? [sDomain[reverse ? 1 : 0]] : datum['category'] === 'serpentine' ? pluck(data('serpentineDomain'), 'domain') : datum['category'] === 'milestone' ? pluck(data('dataset'), 'domain') : datum['category']==='tick' ? pluck(data('tickDomain'), 'domain') : datum['category'] === 'end' ? [sDomain[reverse ? 0 : 1]] : null",
          "as": "domain"
        },
        {"type": "flatten", "fields": ["domain"]},
        {"type": "formula", "expr": "+datum['domain']", "as": "domain"},
        {
          "type": "window",
          "ops": ["row_number"],
          "sort": {"field": "domain"},
          "groupby": ["category"],
          "as": ["id"]
        },
        {
          "type": "formula",
          "expr": "scale('sS1', datum['domain'])",
          "as": "sK"
        },
        {
          "type": "formula",
          "expr": "floor(datum['sK'] / (sW + sH*PI/2))",
          "as": "i"
        },
        {"type": "formula", "expr": "datum['sK'] % (sW + sH*PI/2)", "as": "r"},
        {"type": "formula", "expr": "(datum['r'] - sW)/(sH/2)", "as": "alpha"},
        {
          "type": "formula",
          "expr": "(((datum['i']+1)*sWsA)-sA) >= datum['sK'] ? 'straight' : 'arc'",
          "as": "type"
        },
        {
          "type": "formula",
          "expr": "(datum['i']%2 == 0) ? min(datum['r'],sW) : max(sW-datum['r'], 0)",
          "as": "xStraight"
        },
        {
          "type": "formula",
          "expr": "datum['type'] === 'straight' ? datum['xStraight'] : datum['xStraight'] + (datum['i']%2 == 0 ? sin(datum['alpha'])*sH/2 : -sin(datum['alpha'])*sH/2)",
          "as": "x"
        },
        {
          "type": "formula",
          "expr": "datum['type'] === 'straight' ? datum['i']*sH : (datum['i']*sH) + (1 - cos(datum['alpha']))*sH/2",
          "as": "y"
        },
        {
          "type": "formula",
          "expr": "datum['type'] === 'straight' ? null : datum['i']%2===0?'right':'left'",
          "as": "side"
        },
        {
          "type": "formula",
          "expr": "datum['type'] === 'straight' ? null : datum['alpha']<PI/2?'top':'bottom'",
          "as": "hemisphere"
        },
        {
          "type": "formula",
          "expr": "datum['type'] === 'straight' ? 0 : (datum['side'] === 'left' ? -1 : 1) *datum['alpha']*(180/PI)+(datum['alpha'] < PI/2 ? 0 : 180)",
          "as": "labelAngle"
        },
        {
          "type": "formula",
          "expr": "datum['i']%2===0 ?'→':'←'",
          "as": "direction"
        },
        {
          "type": "formula",
          "expr": "datum['type'] === 'straight' ? datum['direction'] : datum['side'] === 'left' ? datum['hemisphere'] === 'top'? '←' : '→' :  datum['hemisphere'] === 'top'? '→' : '←'",
          "as": "direction"
        }
      ]
    },
    {
      "name": "serpentine",
      "source": "componentEncodings",
      "transform": [
        {"type": "filter", "expr": "datum['category'] === 'serpentine'"}
      ]
    },
    {
      "name": "ticks",
      "source": "componentEncodings",
      "transform": [
        {"type": "filter", "expr": "datum['category'] === 'tick'"},
        {
          "type": "formula",
          "expr": "!isValid(datum['side']) ? (tLO+3.5) : datum['side'] === 'right' ? (round(datum['alpha']*(180/PI)) >= 90 ? -1 : 1.75) * (tLO+3.5) : (round(datum['alpha']*(180/PI)) > 89 ? -1 : 1.75) * (tLO+3.5)",
          "as": "dy"
        }
      ]
    },
    {
      "name": "domain_extent",
      "source": "componentEncodings",
      "transform": [
        {
          "type": "filter",
          "expr": "datum['category'] === 'start' || datum['category'] === 'end'"
        },
        {
          "type": "formula",
          "expr": "datum['category'] === 'start' ? 'right' : datum['direction'] === '←' && datum['type'] === 'straight' ? 'right' : datum['side'] === 'left' ? 'right' : 'left'",
          "as": "align"
        },
        {
          "type": "formula",
          "expr": "datum['category'] === 'start' ? -tLO-5 :  datum['direction'] === '←'  && datum['type'] === 'straight' ? -tLO-5 : datum['side'] === 'left' ? -tLO-5 : tLO+5",
          "as": "dx"
        }
      ]
    },
    {
      "name": "segment_ends",
      "source": "componentEncodings",
      "transform": [
        {
          "type": "filter",
          "expr": "includeArrows && datum['category'] === 'serpentine'"
        },
        {
          "type": "joinaggregate",
          "fields": ["id", "id"],
          "ops": ["min", "max"],
          "groupby": ["i"],
          "as": ["minId", "maxId"]
        },
        {
          "type": "filter",
          "expr": "datum['id'] === (reverse ? datum['maxId'] : datum['minId'])"
        }
      ]
    },
    {
      "name": "footer",
      "values": [
        {
          "id": 1,
          "text": [
            "Data Source:",
            "https://ourworldindata.org/mass-extinctions"
          ],
          "href": "https://ourworldindata.org/mass-extinctions"
        },
        {
          "id": 2,
          "text": ["Icons:", "https://fontawesome.com/"],
          "href": "https://fontawesome.com/"
        },
        {
          "id": 3,
          "text": ["Data Viz By:", "Madison Giammaria"],
          "href": "https://www.linkedin.com/in/madison-giammaria-58463b33"
        }
      ]
    },
    {
      "name": "milestones",
      "source": "componentEncodings",
      "transform": [
        {"type": "filter", "expr": "datum['category'] === 'milestone'"},
        {
          "type": "lookup",
          "key": "domain",
          "from": "dataset",
          "fields": ["domain"],
          "values": ["label", "color"]
        },
        {
          "type": "formula",
          "expr": "!isValid(datum['side']) ? -(mO) : datum['side'] === 'right' ? (round(datum['alpha']*(180/PI)) >= 90 ? 1 : -0.5) * (mO+3.5) : (round(datum['alpha']*(180/PI)) > 89 ? 1 : -0.5) * (mO+3.5)",
          "as": "dy"
        },
        {
          "type": "formula",
          "expr": "(isValid(hoverFocus) && hoverFocus['domain']===datum['domain']) ? 1 : 0.4",
          "as": "fillOpacity"
        }
      ]
    }
  ],
  "config": {}
};
    vegaEmbed("#vis", spec, {mode: "vega"}).then(console.log).catch(console.warn);
  </script>
</body>
</html>
